{"id":"aa1396e1-dcbf-4f5a-951a-ee118c8234b3","revision":0,"last_node_id":22,"last_link_id":22,"nodes":[{"id":12,"type":"PreviewAny","pos":[1900,860],"size":[320,130],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":10}],"outputs":[],"title":"Trimmed Duration (s)","properties":{"Node name for S&R":"PreviewAny"},"widgets_values":[null,null,null]},{"id":15,"type":"PreviewAny","pos":[1511.2109374999998,1280.5133928571424],"size":[610,230],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":13}],"outputs":[],"title":"ASR Transcript","properties":{"Node name for S&R":"PreviewAny"},"widgets_values":[null,null,null]},{"id":1,"type":"MarkdownNote","pos":[20,20],"size":[620,360],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"title":"How To Use","properties":{},"widgets_values":["## Voice Clone (Audio or Video -> Trim -> QwenASR -> User QwenTTS)\n\n1. Upload either `LoadAudio` OR `LoadVideo`.\n2. In **Switch (Source Selector)**: `switch=false` uses audio file, `switch=true` uses video audio track.\n3. Trim with `start_index` + `duration` in **Trim Audio Duration**.\n4. ASR runs with **Qwen/Qwen3-ASR-1.7B** + **bf16** on trimmed audio.\n5. `reference_text` is always from ASR transcript.\n6. In **Switch (Target Text Selector)**: `switch=false` uses manual target text, `switch=true` uses ASR transcript as target text.\n7. Optional style/tone instruction goes into **Instruction Text** and feeds your custom node.\n\nBest practice for reference clip: clean speech, low noise, ~8-20 seconds."],"color":"#2a2f3a","bgcolor":"#3f4959"},{"id":14,"type":"AILab_Qwen3ASR","pos":[1061.2109374999998,1280.5133928571424],"size":[420,230],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":12},{"localized_name":"model","name":"model","shape":7,"type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"precision","name":"precision","shape":7,"type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"language","name":"language","shape":7,"type":"COMBO","widget":{"name":"language"},"link":null},{"localized_name":"hints","name":"hints","shape":7,"type":"STRING","widget":{"name":"hints"},"link":11},{"localized_name":"unload_models","name":"unload_models","shape":7,"type":"BOOLEAN","widget":{"name":"unload_models"},"link":null}],"outputs":[{"localized_name":"TEXT","name":"TEXT","type":"STRING","links":[13,14,16]}],"properties":{"Node name for S&R":"AILab_Qwen3ASR"},"widgets_values":["Qwen/Qwen3-ASR-1.7B","bf16","auto","",true],"color":"#151c19","bgcolor":"#444d49"},{"id":9,"type":"Audio Duration","pos":[1161.7299107142853,877.8404017857144],"size":[330,142],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":6},{"localized_name":"audio_path","name":"audio_path","shape":7,"type":"STRING","widget":{"name":"audio_path"},"link":null},{"localized_name":"fps","name":"fps","shape":7,"type":"FLOAT","widget":{"name":"fps"},"link":null}],"outputs":[{"localized_name":"duration_int","name":"duration_int","type":"INT","links":null},{"localized_name":"duration_float","name":"duration_float","type":"FLOAT","links":[9]},{"localized_name":"frames","name":"frames","type":"INT","links":null},{"localized_name":"audio_path","name":"audio_path","type":"STRING","links":null}],"title":"Source Duration","properties":{"Node name for S&R":"Audio Duration"},"widgets_values":["",0]},{"id":11,"type":"PreviewAny","pos":[1898.1194196428576,663.2142857142852],"size":[320,130],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":9}],"outputs":[],"title":"Source Duration (s)","properties":{"Node name for S&R":"PreviewAny"},"widgets_values":[null,null,null]},{"id":10,"type":"Audio Duration","pos":[1530,720],"size":[330,142],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":8},{"localized_name":"audio_path","name":"audio_path","shape":7,"type":"STRING","widget":{"name":"audio_path"},"link":null},{"localized_name":"fps","name":"fps","shape":7,"type":"FLOAT","widget":{"name":"fps"},"link":null}],"outputs":[{"localized_name":"duration_int","name":"duration_int","type":"INT","links":null},{"localized_name":"duration_float","name":"duration_float","type":"FLOAT","links":[10]},{"localized_name":"frames","name":"frames","type":"INT","links":null},{"localized_name":"audio_path","name":"audio_path","type":"STRING","links":null}],"title":"Trimmed Duration","properties":{"Node name for S&R":"Audio Duration"},"widgets_values":["",0]},{"id":21,"type":"SaveAudio","pos":[2666.8359375000005,1993.0859374999995],"size":[300,112],"flags":{},"order":21,"mode":4,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":21},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null}],"outputs":[],"properties":{"Node name for S&R":"SaveAudio"},"widgets_values":["audio/QwenClone"]},{"id":17,"type":"ComfySwitchNode","pos":[1729.8381696428573,1750.8482142857142],"size":[410,170],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"on_false","name":"on_false","type":"STRING","link":15},{"localized_name":"on_true","name":"on_true","type":"STRING","link":16},{"localized_name":"switch","name":"switch","type":"BOOLEAN","widget":{"name":"switch"},"link":null}],"outputs":[{"localized_name":"output","name":"output","type":"STRING","links":[17]}],"title":"Switch (Target Text Selector)","properties":{"Node name for S&R":"ComfySwitchNode"},"widgets_values":[false]},{"id":19,"type":"User_Qwen3TTSVoiceCloneInstr_Advanced","pos":[2194.079241071428,1623.2142857142856],"size":[410,690],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"reference_audio","name":"reference_audio","shape":7,"type":"AUDIO","link":18},{"localized_name":"voice","name":"voice","shape":7,"type":"VOICE","link":null},{"localized_name":"target_text","name":"target_text","type":"STRING","widget":{"name":"target_text"},"link":17},{"localized_name":"model_size","name":"model_size","type":"COMBO","widget":{"name":"model_size"},"link":null},{"localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"language","name":"language","type":"COMBO","widget":{"name":"language"},"link":null},{"localized_name":"reference_text","name":"reference_text","shape":7,"type":"STRING","widget":{"name":"reference_text"},"link":14},{"localized_name":"x_vector_only","name":"x_vector_only","shape":7,"type":"BOOLEAN","widget":{"name":"x_vector_only"},"link":null},{"localized_name":"instruct","name":"instruct","shape":7,"type":"STRING","widget":{"name":"instruct"},"link":19},{"localized_name":"max_new_tokens","name":"max_new_tokens","shape":7,"type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"localized_name":"do_sample","name":"do_sample","shape":7,"type":"BOOLEAN","widget":{"name":"do_sample"},"link":null},{"localized_name":"top_p","name":"top_p","shape":7,"type":"FLOAT","widget":{"name":"top_p"},"link":null},{"localized_name":"top_k","name":"top_k","shape":7,"type":"INT","widget":{"name":"top_k"},"link":null},{"localized_name":"temperature","name":"temperature","shape":7,"type":"FLOAT","widget":{"name":"temperature"},"link":null},{"localized_name":"repetition_penalty","name":"repetition_penalty","shape":7,"type":"FLOAT","widget":{"name":"repetition_penalty"},"link":null},{"localized_name":"attention","name":"attention","shape":7,"type":"COMBO","widget":{"name":"attention"},"link":null},{"localized_name":"unload_models","name":"unload_models","shape":7,"type":"BOOLEAN","widget":{"name":"unload_models"},"link":null},{"localized_name":"seed","name":"seed","shape":7,"type":"INT","widget":{"name":"seed"},"link":null}],"outputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","links":[20,21]}],"properties":{"Node name for S&R":"User_Qwen3TTSVoiceCloneInstr_Advanced"},"widgets_values":["Hello, this is a cloned voice.","1.7B","auto","bf16","Auto","",true,"",2048,true,0.95,50,1.3,1,"auto",true,709686477876678,"randomize"]},{"id":5,"type":"ComfySwitchNode","pos":[771.3002232142858,490.15625],"size":[330,160],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"on_false","name":"on_false","type":"AUDIO","link":2},{"localized_name":"on_true","name":"on_true","type":"AUDIO","link":3},{"localized_name":"switch","name":"switch","type":"BOOLEAN","widget":{"name":"switch"},"link":null}],"outputs":[{"localized_name":"output","name":"output","type":"AUDIO","links":[4,5,6]}],"title":"Switch (Source Selector)","properties":{"Node name for S&R":"ComfySwitchNode"},"widgets_values":[true]},{"id":13,"type":"PrimitiveStringMultiline","pos":[414.48102678571485,1354.151785714285],"size":[620,180],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[11]}],"title":"ASR Hints (Optional)","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["Important terms: ComfyUI, Qwen3-ASR, Qwen3-TTS\nUse exact casing for these terms."]},{"id":2,"type":"LoadAudio","pos":[35.44084821428573,485.23437500000006],"size":[320,140],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"COMBO","widget":{"name":"audio"},"link":null},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"AUDIOUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"AUDIO","name":"AUDIO","type":"AUDIO","links":[2]}],"properties":{"Node name for S&R":"LoadAudio"},"widgets_values":["ComfyUI_00029_.mp4",null,null]},{"id":4,"type":"GetVideoComponents","pos":[401.6761756702708,622.9960658961525],"size":[320,120],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"video","name":"video","type":"VIDEO","link":22}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","links":null},{"localized_name":"audio","name":"audio","type":"AUDIO","links":[3]},{"localized_name":"fps","name":"fps","type":"FLOAT","links":null}],"properties":{"Node name for S&R":"GetVideoComponents"},"widgets_values":[]},{"id":20,"type":"PreviewAudio","pos":[2648.772321428572,1756.2053571428573],"size":[311.35044642857156,98.40736607142867],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":20},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null}],"outputs":[],"properties":{"Node name for S&R":"PreviewAudio"},"widgets_values":[]},{"id":3,"type":"LoadVideo","pos":[34.57589285714285,704.268973214286],"size":[320,394],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"file","name":"file","type":"COMBO","widget":{"name":"file"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"VIDEO","name":"VIDEO","type":"VIDEO","links":[1]}],"properties":{"Node name for S&R":"LoadVideo"},"widgets_values":["videoplayback.mp4","image"]},{"id":7,"type":"TrimAudioDuration","pos":[1157.7232142857151,668.7109374999994],"size":[330,140],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":5},{"localized_name":"start_index","name":"start_index","type":"FLOAT","widget":{"name":"start_index"},"link":null},{"localized_name":"duration","name":"duration","type":"FLOAT","widget":{"name":"duration"},"link":null}],"outputs":[{"localized_name":"AUDIO","name":"AUDIO","type":"AUDIO","links":[7,8,12,18]}],"properties":{"Node name for S&R":"TrimAudioDuration"},"widgets_values":[0,13]},{"id":16,"type":"PrimitiveStringMultiline","pos":[1082.8013392857142,1762.3772321428573],"size":[620,180],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[15]}],"title":"Manual Target Text","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["Don't you dare come to my white party in beige and then have opinions. That's not off-white, Linda, that's khaki. You wore khaki to my white party. My decorator almost had a seizure. And then you had the nerve to compliment my champagne like you know what brut means. You were drinking prosecco out of a red Solo cup at your birthday last month. I have the photos. I will post them. Try me. I am one glass of pinot away from ending friendships tonight and I already had two."]},{"id":18,"type":"PrimitiveStringMultiline","pos":[1079.6874999999993,2030.6473214285718],"size":[620,180],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[19]}],"title":"Instruction Text (Optional)","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["Speak in an outraged, dramatic wealthy woman's voice. Genuinely offended over something absurdly trivial. Gets more unhinged with each sentence. Fast delivery with sharp emphasis on key words. Barely holding it together."]},{"id":6,"type":"PreviewAudio","pos":[1173.5714285714287,469.53125000000017],"size":[300,88],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":4},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null}],"outputs":[],"title":"Preview Selected Source","properties":{"Node name for S&R":"PreviewAudio"},"widgets_values":[]},{"id":22,"type":"Video Slice","pos":[390.12834821428555,838.5357142857142],"size":[320,170],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"video","name":"video","type":"VIDEO","link":1},{"localized_name":"start_time","name":"start_time","type":"FLOAT","widget":{"name":"start_time"},"link":null},{"localized_name":"duration","name":"duration","type":"FLOAT","widget":{"name":"duration"},"link":null},{"localized_name":"strict_duration","name":"strict_duration","type":"BOOLEAN","widget":{"name":"strict_duration"},"link":null}],"outputs":[{"localized_name":"VIDEO","name":"VIDEO","type":"VIDEO","links":[22]}],"title":"Video Audio Guard","properties":{"Node name for S&R":"Video Slice"},"widgets_values":[0,45,false]},{"id":8,"type":"PreviewAudio","pos":[1530,550],"size":[300,88],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"AUDIO","link":7},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null}],"outputs":[],"title":"Preview Trimmed Reference","properties":{"Node name for S&R":"PreviewAudio"},"widgets_values":[]}],"links":[[1,3,0,22,0,"VIDEO"],[2,2,0,5,0,"AUDIO"],[3,4,1,5,1,"AUDIO"],[4,5,0,6,0,"AUDIO"],[5,5,0,7,0,"AUDIO"],[6,5,0,9,0,"AUDIO"],[7,7,0,8,0,"AUDIO"],[8,7,0,10,0,"AUDIO"],[9,9,1,11,0,"FLOAT"],[10,10,1,12,0,"FLOAT"],[11,13,0,14,4,"STRING"],[12,7,0,14,0,"AUDIO"],[13,14,0,15,0,"STRING"],[14,14,0,19,7,"STRING"],[15,16,0,17,0,"STRING"],[16,14,0,17,1,"STRING"],[17,17,0,19,2,"STRING"],[18,7,0,19,0,"AUDIO"],[19,18,0,19,9,"STRING"],[20,19,0,20,0,"AUDIO"],[21,19,0,21,0,"AUDIO"],[22,22,0,4,0,"VIDEO"]],"groups":[{"id":1,"title":"1) Input + Curation","bounding":[10,390,2240,760],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"2) QwenASR 1.7B","bounding":[1011.2109374999998,1230.5133928571424,1130,310],"color":"#3f9e6f","font_size":24,"flags":{}},{"id":3,"title":"3) Clone + Save","bounding":[1043.1417410714287,1641.0044642857144,1930,650],"color":"#9e6f3f","font_size":24,"flags":{}}],"config":{},"extra":{"workflowRendererVersion":"LG","ue_links":[],"ds":{"scale":0.7725785736363939,"offset":[-306.86436560566034,-25.53538271989166]},"links_added_by_ue":[],"frontendVersion":"1.38.14","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}